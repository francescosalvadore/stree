===================================
STREAmS flow cases
===================================

STREAmS has been tailored to carry out DNS of three 
types of canonical compressible flow configurations:

- compressible plane channel flow, 
- compressible boundary layer over a flat plate, 
- shock wave/boundary layer interaction generated by oblique shock impingement.

For all the flow cases, :math:`x` indicates the streamwise coordinate, 
:math:`y` indicates the wall-normal coordinate, and :math:`z` indicates the 
spanwise coordinate.  
The dimensions of the computational domain in the corresponding directions
are :math:`L_x`, :math:`L_y`, and :math:`L_z`.

The main parameters of each case are reported in the following.

-------------------------------------
Compressible plane channel flow
-------------------------------------

.. image:: ./figures/Channel_case.png
   :width: 600

Simulations of the compressible plane channel flow 
are carried out imposing a constant flow rate. 
The height of the domain :math:`L_y` is equal to :math:`2\,h`, 
where :math:`h` thus indicates the half-height of the channel. 

*Bulk quantites* are indicated with :math:`B` subscript and are defined as: 

- bulk density
.. math::

   \rho_B = \frac{1}{V} \int_V \rho\, \mathrm{d}V

- bulk velocity
.. math::

   U_B = \frac{1}{\rho_B\,V} \int_V \rho\,u\, \mathrm{d}V

- bulk temperature
.. math::

   T_B = \frac{1}{\rho_B\,U_B\,V} \int_V \rho\,u\,T\, \mathrm{d}V

where :math:`V` is the volume of the computational domain, 
:math:`\rho` is the density, 
:math:`u` is the streamwise velocity, 
and :math:`T` is the temperature.  

*Reference quantities* are indicated with :math:`R` subscript and are defined as:

- reference length
.. math::

   L_R = h

- reference density
.. math::

   \rho_R = \rho_B

- reference temperature
.. math::

   T_R = T_w

- reference velocity
.. math::

   U_R = \sqrt{R\,T_w}

- reference time
.. math::

   t_R = L_R/U_R

where :math:`T_w` is the wall temperature, and :math:`R` is the gas constant.

Relevant flow *nondimensional parameters* are: 

- estimated friction Reynolds number 
.. math::

   Re_\tau = \frac{u_\tau\,h}{\nu_w}

- bulk Reynolds number based on the bulk temperature
.. math::

   Re_B = \frac{\rho_B\,U_B\,h}{\mu(T_B)}

- bulk Reynolds number based on the wall temperature
.. math::

   \widetilde{Re}_B = \frac{\rho_B\,U_B\,h}{\mu(T_w)}

- bulk Mach number based on the bulk temperature
.. math::

   M_B = \frac{U_B}{\sqrt{\gamma\,R\,T_B}}

- bulk Mach number based on the wall temperature
.. math::

   \widetilde{M}_B = \frac{U_B}{\sqrt{\gamma\,R\,T_w}}

where :math:`u_\tau` is the friction velocity, 
:math:`\nu_w` is the kinematic viscosity at the wall, 
:math:`\mu(T)` is the dynamic viscosity at temperature :math:`T`, 
and :math:`\gamma = C_P/C_V` is the heat capacity ratio, 
obtained dividing the specific heat capacity at constant pressure :math:`C_P`
by the specific heat capacity at constant volume :math:`C_V`.

For what concerns the bulk temperature, two different options are available for the simulations:

-- *Fixed bulk temperature.* In this case, the user must supply the code 
with the desired values of :math:`M_B`, :math:`Re_\tau`, and an 
estimate of :math:`\theta` in the input file. 
The code provides the corresponding values of :math:`\widetilde{M}_B`, 
:math:`\widetilde{Re}_B`, and :math:`Re_B`. CITA COLEMANN e MODESTI 

-- *Freely-evolving bulk temperature.* In this case, the user must supply the 
code with the desired values of :math:`\widetilde{M}_B` and 
:math:`Re_\tau` only, while :math:`\theta` must be set to 
a value less than :math:`-1`. 
The code provides the value of :math:`\widetilde{Re}_B`, and 
an estimate of :math:`M_B` and :math:`Re_B`. CITA ROUGHNESS JFM

-------------------------------------
Compressible boundary layer
-------------------------------------

.. image:: ./figures/BLay_case.png
   :width: 600

Simulations of the compressible boundary layer
are carried out imposing a null pressure gradient. 

*Reference quantities* are indicated with :math:`R` 
subscript and are defined as:

- reference length
.. math::

   L_R = \delta_0

- reference density
.. math::

   \rho_R = \rho_\infty

- reference temperature 
.. math::

   T_R = T_\infty

- reference velocity
.. math::

   U_R = \sqrt{R\,T_\infty}

- reference time
.. math::

   t_R = L_R/U_R

where :math:`\delta_0` is the boundary layer thickness at the 
beginning of the domain (???), :math:`\rho_\infty` is 
the free-stream density, and :math:`T_\infty` is 
the free-stream temperature.

Relevant flow *nondimensional parameters* are: 

- estimated friction Reynolds number 
.. math::

   Re_\tau = \frac{u_\tau\,\delta_0}{\nu_w}

- free-stream Mach number
.. math::

   M_\infty = \frac{U_\infty}{\sqrt{\gamma\,R\,T_\infty}}

where :math:`U_\infty` is the free-stream velocity.

-------------------------------------
Shock wave/boundary layer interaction
-------------------------------------

.. image:: ./figures/SBLI_case.png
   :width: 600

Simulations of the shock wave/boundary layer interaction
assume that an oblique shock wave from the top surface of the domain 
impinges on a boundary layer developing on the flat bottom surface. 

*Reference quantities* are indicated with :math:`R` subscript and, 
as in the case of the compressible boundary layer, are defined as:

- reference length
.. math::

   L_R = \delta_0

- reference density
.. math::

   \rho_R = \rho_\infty

- reference temperature 
.. math::

   T_R = T_\infty

- reference velocity
.. math::

   U_R = \sqrt{R\,T_\infty}

- reference time
.. math::

   t_R = L_R/U_R

where :math:`\delta_0` is the thickness of the undisturbed 
boundary layer at the beginning of the domain. (???)

Relevant flow *nondimensional parameters*, as in  
the case of the compressible boundary layer, are: 

- estimated friction Reynolds number 
.. math::

   Re_\tau = \frac{u_\tau\,\delta_0}{\nu_w}

- free-stream Mach number
.. math::

   M_\infty = \frac{U_\infty}{\sqrt{\gamma\,R\,T_\infty}}

In order to define the shock system, the user must provide also 
the two following parameters: 

- the *shock impingment location* :math:`x_{imp}^s`, which is the longitudinal coordinate where the impinging shock would intersect the bottom surface.

- The *shock wave angle* :math:`\phi^s`, which is the acute angle between the shock and the top (or bottom) surface.

